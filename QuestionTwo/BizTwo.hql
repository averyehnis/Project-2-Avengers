USE GENDER_STATS_DB;

CREATE TABLE IF NOT EXISTS GENDER_BIZTWO (COUNTRY_NAME STRING, INDICATOR_NAME STRING, YEAR_2000 DECIMAL(10,5), YEAR_2001 DECIMAL(10,5), YEAR_2002 DECIMAL(10,5), YEAR_2003 DECIMAL(10,5), YEAR_2004 DECIMAL(10,5), YEAR_2005 DECIMAL(10,5), YEAR_2006 DECIMAL(10,5), YEAR_2007 DECIMAL(10,5), YEAR_2008 DECIMAL(10,5), YEAR_2009 DECIMAL(10,5), YEAR_2010 DECIMAL(10,5), YEAR_2011 DECIMAL(10,5), YEAR_2012 DECIMAL(10,5), YEAR_2013 DECIMAL(10,5), YEAR_2014 DECIMAL(10,5), YEAR_2015 DECIMAL(10,5), YEAR_2016 DECIMAL(10,5)) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|';

LOAD DATA INPATH '/user/cloudera/Sqoop/BizTwo' INTO TABLE GENDER_BIZTWO;

add jar /home/cloudera/p1workspace/UDFTest/target/QuestionTwoUdf.jar;
create temporary function testUDF as 'com.revature.udf.UDFHive';
CREATE TABLE BizTwo AS select testUDF(year_2000,year_2001,year_2002,year_2003,year_2004,year_2005,year_2006,year_2007,year_2008,year_2009,year_2010,year_2011,year_2012,year_2013,year_2014,year_2015,year_2016) AS average_change from GENDER_BIZTWO;
